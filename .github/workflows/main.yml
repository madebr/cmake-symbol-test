name: Build

on: [push, pull_request]

jobs:
  build-gcc:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        platform:
          - { name: Linux (gcc 10), version: 10 }
          - { name: Linux (gcc 11), version: 11 }
          - { name: Linux (gcc 12), version: 12 }
          - { name: Linux (gcc 13), version: 13 }

    container:
      image: gcc:${{ matrix.platform.version }}

    steps:
      - uses: actions/checkout@v4
      - name: CMake (Configure)
        run: |
          cmake -B build

  build-clang:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        platform:
          - { name: Linux (clang 11), version: 11 }
          - { name: Linux (clang 12), version: 12 }
          - { name: Linux (clang 13), version: 13 }
          - { name: Linux (clang 14), version: 14 }
          - { name: Linux (clang 15), version: 15 }
          - { name: Linux (clang 16), version: 16 }
          - { name: Linux (clang 17), version: 17 }
          - { name: Linux (clang 18), version: 18 }

    container:
      image: teeks99/clang-ubuntu:${{ matrix.build_config.version }}

    steps:
      - uses: actions/checkout@v4
      - name: Setup
        run: |
          echo "CC=clang-${{ matrix.platform.version }}
          echo "CXX=clang-${{ matrix.platform.version }}
      - name: CMake (Configure)
        run: |
          cmake -B build

  build-win-mac:
    runs-on: ${{ matrix.platform.os }}
    strategy:
      fail-fast: false
      matrix:
        platform:
          - { name: Windows,        os: windows-latest }
          - { name: macOS,          os: macos-latest }

    steps:
      - uses: actions/checkout@v4
      - name: CMake (Configure)
        run: |
          cmake -B build
